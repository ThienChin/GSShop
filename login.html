<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Đăng nhập hoặc đăng ký tài khoản tại GS-Shop để mua PC, laptop và phụ kiện công nghệ chất lượng."
    />
    <meta name="author" content="GSShop" />
    <title>Đăng Nhập | GS-Shop</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/font-awesome.min.css" rel="stylesheet" />
    <link href="css/prettyPhoto.css" rel="stylesheet" />
    <link href="css/price-range.css" rel="stylesheet" />
    <link href="css/animate.css" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <link href="css/responsive.css" rel="stylesheet" />
    <link href="css/login.css" rel="stylesheet" />
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="images/ico/favicon.ico" />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="images/ico/apple-touch-icon-144-precomposed.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="114x114"
      href="images/ico/apple-touch-icon-114-precomposed.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      sizes="72x72"
      href="images/ico/apple-touch-icon-72-precomposed.png"
    />
    <link
      rel="apple-touch-icon-precomposed"
      href="images/ico/apple-touch-icon-57-precomposed.png"
    />
  </head>
  <body>
    <header id="header">
      <div class="header_top">
        <div class="container">
          <div class="row">
            <div class="col-sm-6">
              <div class="contactinfo">
                <ul class="nav nav-pills">
                  <li>
                    <a href=""><i class="fa fa-phone"></i> +84 123 456 789</a>
                  </li>
                  <li>
                    <a href=""
                      ><i class="fa fa-envelope"></i>
                      <span
                        class="__cf_email__"
                        data-cfemail="5764626767786563177064647f7867396179"
                        >[email protected]</span
                      ></a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="social-icons pull-right">
                <ul class="nav navbar-nav">
                  <li>
                    <a href="https://facebook.com/GSShop"
                      ><i class="fa fa-facebook"></i
                    ></a>
                  </li>
                  <li>
                    <a href="https://x.com/GSShop"><i class="fa fa-x"></i></a>
                  </li>
                  <li>
                    <a href=""><i class="fa fa-linkedin"></i></a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="header-middle">
        <div class="container">
          <div class="row">
            <div class="col-sm-4">
              <div class="logo pull-left">
                <a href="index.html"
                  ><img src="images/home/logo.png" alt="GSShop Logo"
                /></a>
              </div>
            </div>
            <div class="col-sm-8">
              <div class="shop-menu pull-right">
                <ul class="nav navbar-nav">
                  <li>
                    <a href=""><i class="fa fa-user"></i> Tài khoản</a>
                  </li>
                  <li>
                    <a href=""><i class="fa fa-star"></i> Yêu thích</a>
                  </li>
                  <li>
                    <a href="checkout.html"
                      ><i class="fa fa-crosshairs"></i> Thanh toán</a
                    >
                  </li>
                  <li>
                    <a href="cart.html"
                      ><i class="fa fa-shopping-cart"></i> Giỏ hàng</a
                    >
                  </li>
                  <li>
                    <a href="login.html" class="active"
                      ><i class="fa fa-lock"></i> Đăng nhập</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="header-bottom">
        <div class="container">
          <div class="row">
            <div class="col-sm-9">
              <div class="navbar-header">
                <button
                  type="button"
                  class="navbar-toggle"
                  data-toggle="collapse"
                  data-target=".navbar-collapse"
                >
                  <span class="sr-only">Chuyển đổi điều hướng</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>
              <div class="mainmenu pull-left">
                <ul class="nav navbar-nav collapse navbar-collapse">
                  <li><a href="index.html">Trang chủ</a></li>
                  <li class="dropdown">
                    <a href="#">Sản phẩm<i class="fa fa-angle-down"></i></a>
                    <ul role="menu" class="sub-menu">
                      <li><a href="shop.html">Danh sách sản phẩm</a></li>
                      <li>
                        <a href="product-details.html">Chi tiết sản phẩm</a>
                      </li>
                      <li><a href="checkout.html">Thanh toán</a></li>
                      <li><a href="cart.html">Giỏ hàng</a></li>
                      <li><a href="login.html" class="active">Đăng nhập</a></li>
                    </ul>
                  </li>
                  <li><a href="contact-us.html">Liên hệ</a></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="search_box pull-right">
                <input type="text" placeholder="Tìm kiếm sản phẩm..." />
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section id="form">
      <div class="form-container">
        <div class="form-tabs">
          <button class="form-tab active" onclick="toggleForm('login')">
            Đăng nhập
          </button>
          <button class="form-tab" onclick="toggleForm('signup')">
            Đăng ký
          </button>
        </div>
        <div class="login-form" id="login-form-container">
          <div class="social-login">
            <a href="#" onclick="socialLogin('google')"
              ><img
                src="https://img.icons8.com/color/20/000000/google-logo.png"
                alt="Google"
              />Google</a
            >
            <a href="#" onclick="socialLogin('zalo')"
              ><img
                src="https://img.icons8.com/color/20/000000/zalo.png"
                alt="Zalo"
              />Zalo</a
            >
          </div>
          <div class="divider"><span>hoặc</span></div>
          <form id="login-form">
            <div class="form-group">
              <label for="login-phone">Nhập số điện thoại</label>
              <input
                type="tel"
                placeholder="Nhập số điện thoại"
                required
                id="login-phone"
              />
              <div class="error-message" id="login-phone-error"></div>
            </div>
            <div class="form-group">
              <label for="login-password">Nhập mật khẩu</label>
              <input
                type="password"
                placeholder="Nhập mật khẩu"
                required
                id="login-password"
              />
              <div class="error-message" id="login-password-error"></div>
            </div>
            <div class="checkbox-container">
              <label class="checkbox-label">
                <input type="checkbox" id="remember-me" />
                Remember
              </label>
              <a href="#" class="forgot-password" onclick="forgotPassword()"
                >Quên mật khẩu?</a
              >
            </div>
            <button type="submit" class="btn-login">Đăng nhập</button>
          </form>
        </div>
        <div class="signup-form hidden" id="signup-form-container">
          <div class="social-login">
            <a href="#" onclick="socialLogin('google')"
              ><img
                src="https://img.icons8.com/color/20/000000/google-logo.png"
                alt="Google"
              />Google</a
            >
            <a href="#" onclick="socialLogin('zalo')"
              ><img
                src="https://img.icons8.com/color/20/000000/zalo.png"
                alt="Zalo"
              />Zalo</a
            >
          </div>
          <div class="divider"><span>hoặc</span></div>
          <form id="signup-form">
            <div class="form-group">
              <label for="signup-name">Họ và tên</label>
              <input
                type="text"
                placeholder="Họ và tên"
                required
                id="signup-name"
              />
              <div class="error-message" id="signup-name-error"></div>
            </div>
            <div class="form-group">
              <label for="signup-phone">Số điện thoại</label>
              <input
                type="tel"
                placeholder="Số điện thoại"
                required
                id="signup-phone"
              />
              <div class="error-message" id="signup-phone-error"></div>
            </div>
            <div class="form-group">
              <label for="signup-password">Mật khẩu</label>
              <input
                type="password"
                placeholder="Mật khẩu (ít nhất 8 ký tự)"
                required
                id="signup-password"
              />
              <div class="error-message" id="signup-password-error"></div>
            </div>
            <div class="form-group">
              <label for="signup-confirm-password">Xác nhận mật khẩu</label>
              <input
                type="password"
                placeholder="Xác nhận mật khẩu"
                required
                id="signup-confirm-password"
              />
              <div
                class="error-message"
                id="signup-confirm-password-error"
              ></div>
            </div>
            <button type="submit" class="btn-login">Đăng ký</button>
          </form>
        </div>
      </div>
    </section>

    <footer id="footer">
      <div class="footer-top">
        <div class="container">
          <div class="row">
            <div class="col-sm-3">
              <div class="companyinfo">
                <h2><span>GS</span>Shop</h2>
                <p>
                  Cung cấp PC, laptop và phụ kiện chất lượng cao với giá cạnh
                  tranh.
                </p>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="address">
                <img src="images/home/map.png" alt="Bản đồ GSShop" />
                <p>123 Đường Lê Lợi, Quận 1, TP. Hồ Chí Minh, Việt Nam</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-widget">
        <div class="container">
          <div class="row">
            <div class="col-sm-2">
              <div class="single-widget">
                <h2>Dịch vụ</h2>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="">Hỗ trợ trực tuyến</a></li>
                  <li><a href="contact-us.html">Liên hệ</a></li>
                  <li><a href="">Tình trạng đơn hàng</a></li>
                  <li><a href="">FAQ</a></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="single-widget">
                <h2>Sản phẩm</h2>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="">Laptop</a></li>
                  <li><a href="">PC</a></li>
                  <li><a href="">Tai nghe</a></li>
                  <li><a href="">Bàn phím</a></li>
                  <li><a href="">Chuột</a></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="single-widget">
                <h2>Chính sách</h2>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="">Điều khoản sử dụng</a></li>
                  <li><a href="">Chính sách bảo mật</a></li>
                  <li><a href="">Chính sách hoàn trả</a></li>
                  <li><a href="">Hệ thống thanh toán</a></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="single-widget">
                <h2>Về GSShop</h2>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="">Thông tin công ty</a></li>
                  <li><a href="">Tuyển dụng</a></li>
                  <li><a href="">Vị trí cửa hàng</a></li>
                  <li><a href="">Chương trình liên kết</a></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-3 col-sm-offset-1">
              <div class="single-widget">
                <h2>Nhận thông tin</h2>
                <form action="#" class="searchform">
                  <input type="text" placeholder="Nhập email của bạn..." />
                  <button type="submit" class="btn btn-default">
                    <i class="fa fa-arrow-circle-o-right"></i>
                  </button>
                  <p>Đăng ký để nhận ưu đãi và tin tức mới nhất từ GSShop.</p>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <div class="container">
          <div class="row">
            <p class="pull-left">
              Copyright © 2025 GSShop. All rights reserved.
            </p>
            <p class="pull-right">Thiết kế bởi GSShop Team</p>
          </div>
        </div>
      </div>
    </footer>

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>
    <script src="js/main.js"></script>
    <script>
      // Kiểm tra định dạng số điện thoại
      function validatePhone(phone) {
        const re = /^[0-9]{10,11}$/;
        return re.test(phone);
      }

      // Kiểm tra độ mạnh mật khẩu
      function validatePassword(password) {
        const re = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
        return re.test(password);
      }

      // Chuyển đổi form
      function toggleForm(form) {
        const loginForm = document.getElementById("login-form-container");
        const signupForm = document.getElementById("signup-form-container");
        const loginTab = document.querySelector(".form-tab:nth-child(1)");
        const signupTab = document.querySelector(".form-tab:nth-child(2)");

        loginForm.classList.toggle("hidden", form !== "login");
        signupForm.classList.toggle("hidden", form !== "signup");
        loginTab.classList.toggle("active", form === "login");
        signupTab.classList.toggle("active", form === "signup");
        clearErrors();
      }

      // Xóa thông báo lỗi
      function clearErrors() {
        document.querySelectorAll(".error-message").forEach((el) => {
          el.style.display = "none";
          el.textContent = "";
        });
      }

      // Xử lý đăng nhập
      document
        .getElementById("login-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          clearErrors();
          const phone = document.getElementById("login-phone").value;
          const password = document.getElementById("login-password").value;
          let hasError = false;

          if (!validatePhone(phone)) {
            document.getElementById("login-phone-error").textContent =
              "Vui lòng nhập số điện thoại hợp lệ (10-11 số).";
            document.getElementById("login-phone-error").style.display =
              "block";
            hasError = true;
          }

          if (!password) {
            document.getElementById("login-password-error").textContent =
              "Vui lòng nhập mật khẩu.";
            document.getElementById("login-password-error").style.display =
              "block";
            hasError = true;
          }

          if (!hasError) {
            fetch("/api/login", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ phone, password }),
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.success) {
                  localStorage.setItem("user", JSON.stringify({ phone }));
                  alert("Đăng nhập thành công!");
                  window.location.href = document.referrer.includes(
                    "login.html"
                  )
                    ? "index.html"
                    : document.referrer || "index.html";
                } else {
                  document.getElementById("login-password-error").textContent =
                    "Số điện thoại hoặc mật khẩu không đúng.";
                  document.getElementById(
                    "login-password-error"
                  ).style.display = "block";
                }
              })
              .catch(() => {
                alert("Đã có lỗi xảy ra. Vui lòng thử lại sau.");
              });
          }
        });

      // Xử lý đăng ký
      document
        .getElementById("signup-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          clearErrors();
          const name = document.getElementById("signup-name").value;
          const phone = document.getElementById("signup-phone").value;
          const password = document.getElementById("signup-password").value;
          const confirmPassword = document.getElementById(
            "signup-confirm-password"
          ).value;
          let hasError = false;

          if (!name) {
            document.getElementById("signup-name-error").textContent =
              "Vui lòng nhập họ và tên.";
            document.getElementById("signup-name-error").style.display =
              "block";
            hasError = true;
          }

          if (!validatePhone(phone)) {
            document.getElementById("signup-phone-error").textContent =
              "Vui lòng nhập số điện thoại hợp lệ (10-11 số).";
            document.getElementById("signup-phone-error").style.display =
              "block";
            hasError = true;
          }

          if (!validatePassword(password)) {
            document.getElementById("signup-password-error").textContent =
              "Mật khẩu phải có ít nhất 8 ký tự, gồm chữ hoa, chữ thường và số.";
            document.getElementById("signup-password-error").style.display =
              "block";
            hasError = true;
          }

          if (password !== confirmPassword) {
            document.getElementById(
              "signup-confirm-password-error"
            ).textContent = "Mật khẩu xác nhận không khớp.";
            document.getElementById(
              "signup-confirm-password-error"
            ).style.display = "block";
            hasError = true;
          }

          if (!hasError) {
            fetch("/api/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ name, phone, password }),
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.success) {
                  alert(`Đăng ký thành công cho ${name}! Vui lòng đăng nhập.`);
                  toggleForm("login");
                  this.reset();
                } else {
                  document.getElementById("signup-phone-error").textContent =
                    "Số điện thoại đã được sử dụng.";
                  document.getElementById("signup-phone-error").style.display =
                    "block";
                }
              })
              .catch(() => {
                alert("Đã có lỗi xảy ra. Vui lòng thử lại sau.");
              });
          }
        });

      // Xử lý quên mật khẩu
      function forgotPassword() {
        const phone = prompt(
          "Nhập số điện thoại của bạn để khôi phục mật khẩu:"
        );
        if (phone && validatePhone(phone)) {
          fetch("/api/forgot-password", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ phone }),
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                alert(`Hướng dẫn khôi phục mật khẩu đã được gửi đến ${phone}.`);
              } else {
                alert("Số điện thoại không tồn tại.");
              }
            })
            .catch(() => {
              alert("Đã có lỗi xảy ra. Vui lòng thử lại sau.");
            });
        } else if (phone) {
          alert("Vui lòng nhập số điện thoại hợp lệ (10-11 số).");
        }
      }

      // Xử lý đăng nhập mạng xã hội
      function socialLogin(provider) {
        alert(
          `Đăng nhập bằng ${
            provider.charAt(0).toUpperCase() + provider.slice(1)
          } đang được phát triển.`
        );
      }

      // Kiểm tra trạng thái đăng nhập
      window.onload = function () {
        const user = JSON.parse(localStorage.getItem("user"));
        if (user) {
          const menu = document.querySelector(".shop-menu ul");
          const loginLink = menu.querySelector('a[href="login.html"]');
          loginLink.innerHTML = `<i class="fa fa-user"></i> ${
            user.phone || user.email
          }`;
          loginLink.href = "#";
          loginLink.onclick = function () {
            localStorage.removeItem("user");
            alert("Đã đăng xuất.");
            window.location.reload();
          };
        }
      };
    </script>
  </body>
</html>
